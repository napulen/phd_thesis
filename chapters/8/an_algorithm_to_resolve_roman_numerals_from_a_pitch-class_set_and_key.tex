% Copyright 2022 Néstor Nápoles López

A \gls{pcset} $\elpcset$ has an interpretation as one of the
Roman numeral numerators $\elnum \in \setnum$ in a subset of
keys $\setkey_{\elpcset} \subset \setkey$ that is described
in \refeq{keys_for_pcset}.

\begin{equation}
    \label{eq:keys_for_pcset}
    \setkey_{\elpcset} = \{\elkey \mid \elkey \in \setkey,
     \: \text{and $\elpcset$ has an interpretation in key $\elkey$}\}
\end{equation}

For example, given the \gls{pcset} $\elpcset =
\pcsetcega{}$, there is an interpretation for that
\gls{pcset} in several keys $\elkey \in \setkey$, as shown
in \refeq{pcset_cega}. This set of keys represents the
subset $\setkey_\elpcset$ for this $\elpcset$, as shown in
\refeq{keys_for_pcset_example}. 

\begin{equation}
    \label{eq:pcset_cega}
    \text{The } \gls{pcset} \text{ } \elpcset = \pcsetcega \text{ in key } \elkey =
    \begin{cases}
        \keyC & \text{ has a numerator } \elnum = \rnvisev \\
        \keye & \text{ has a numerator } \elnum = \rnivsev \\
        \keyF & \text{ has a numerator } \elnum = \rniiisev \\
        \keyG & \text{ has a numerator } \elnum = \rniisev \\
        \keya & \text{ has a numerator } \elnum = \rnisev \\
    \end{cases}
\end{equation}

\begin{equation}
    \label{eq:keys_for_pcset_example}
    \text{if } \elpcset = \pcsetcega \text{ , then } \; 
    \setkey_{\elpcset} = \{ \keyC, \keye, \keyF, \keyG, \keya \}
\end{equation}

Given a pitch class set $\elpcset \in \setpcset$ and a key
$\elkey \in \setkey_\elpcset$, the function
$\Gamma(\elpcset, \elkey) = \elnum$ returns the
corresponding numerator $\elnum$ such that
$\text{pcset}(\elkey$:$\elnum) = \elpcset$, as shown in
\refeq{numerator_from_pcset_key}.

\begin{equation}
    \label{eq:numerator_from_pcset_key}
    \begin{split}
        \elpcset = \pcsetcega \text{, } \; \elkey = \keyC \quad \Gamma(\elpcset, \elkey) = \rnvisev \\
        \elpcset = \pcsetcega \text{, } \; \elkey = \keye \quad \Gamma(\elpcset, \elkey) = \rnivsev \\
    \end{split}
\end{equation}


A limitation of the function $\Gamma$ is that $\forall \;
\elkey \not\in \setkey_\elpcset \; \Gamma(\elpcset, \elkey)
= \varnothing$. This is a foreseeable problem when using
this method to retreive $\elnum$ from the predictions of a
machine learning system, because the pair of $\elpcset$ and
$\elkey$ could be such that $\elkey \not\in
\setkey_\elpcset$. In that case, the Roman numeral numerator
cannot be retrieved directly. However, it can be retrieved
if a tonicization $\elden$ is imposed into the annotation
(i.e., the key changes for that particular chord), such that
$\elden \in \setkey_\elpcset$.
