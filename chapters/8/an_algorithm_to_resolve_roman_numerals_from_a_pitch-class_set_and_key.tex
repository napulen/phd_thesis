% Copyright 2022 Néstor Nápoles López

A \gls{pcset} $\elpcset$ has an interpretation as one of the
Roman numeral numerators $\elnum \in \setnum$ in a subset of
keys $\setkey_{\elpcset} \subset \setkey$ that is described
in \refeq{keys_for_pcset}.

\begin{equation}
    \label{eq:keys_for_pcset}
    \setkey_{\elpcset} = \{\elkey \mid \elkey \in \setkey,
     \: \text{and $\elpcset$ has an interpretation in key $\elkey$}\}
\end{equation}

For example, given the \gls{pcset} $\elpcset =
\pcsetcega{}$, there is an interpretation for that
\gls{pcset} in several keys $\elkey \in \setkey$, as shown
in \refeq{pcset_cega}. This set of keys represents the
subset $\setkey_\elpcset$ for this $\elpcset$, as shown in
\refeq{keys_for_pcset_example}. 

\begin{equation}
    \label{eq:pcset_cega}
    \text{The } \gls{pcset} \text{ } \elpcset = \pcsetcega \text{ in key } \elkey =
    \begin{cases}
        \keyC & \text{ is the pcset}(\elkey\text{:}\elnum)\text{ if } \elnum = \rnvisev \\
        \keye & \text{ is the pcset}(\elkey\text{:}\elnum)\text{ if } \elnum = \rnivsev \\
        \keyF & \text{ is the pcset}(\elkey\text{:}\elnum)\text{ if } \elnum = \rniiisev \\
        \keyG & \text{ is the pcset}(\elkey\text{:}\elnum)\text{ if } \elnum = \rniisev \\
        \keya & \text{ is the pcset}(\elkey\text{:}\elnum)\text{ if } \elnum = \rnisev \\
    \end{cases}
\end{equation}

\begin{equation}
    \label{eq:keys_for_pcset_example}
    \text{if } \elpcset = \pcsetcega \text{ , then } \; 
    \setkey_{\elpcset} = \{ \keyC, \keye, \keyF, \keyG, \keya \}
\end{equation}

Given a \gls{pcset} $\elpcset \in \setpcset$ and a key
$\elkey \in \setkey_\elpcset$, the function
$\Gamma(\elpcset, \elkey) = \elnum$ returns the
corresponding numerator $\elnum$ such that
$\text{pcset}(\elkey$:$\elnum) = \elpcset$, as shown in
\refeq{numerator_from_pcset_key}.

\begin{equation}
    \label{eq:numerator_from_pcset_key}
    \begin{split}
        \elpcset = \pcsetcega \text{, } \; \elkey = \keyC \quad \Gamma(\elpcset, \elkey) = \rnvisev \\
        \elpcset = \pcsetcega \text{, } \; \elkey = \keye \quad \Gamma(\elpcset, \elkey) = \rnivsev \\
    \end{split}
\end{equation}


A limitation of the function $\Gamma$ is that $\forall \;
\elkey \not\in \setkey_\elpcset \; \Gamma(\elpcset, \elkey)
= \varnothing$. This is a foreseeable problem when this
method is used to retrieve a numerator $\elnum$ from a
predicted pair of $\elpcset$ and $\elkey$, generated by a
machine learning system. The reason is that a machine
learning system could predict a $\elkeypred$ such that
$\elkeypred \not\in \setkey_\elpcset$.\footnote{It is
customary in machine learning literature to use the ``hat''
symbol to refer to the predictions of a machine learning
system.} In that case, the Roman numeral numerator cannot be
retrieved directly. However, it can be retrieved if a
tonicized scale degree $\elden$ is imposed into the
annotation (i.e., the key changes for that particular
chord), such that $\elden_{\elkey} \in \setkey_\elpcset$.

In the more complicated case for a given $\elpcset$ and
$\elkey$, where $\elkey \not\in \setkey_\elpcset$, the
numerator $\elnum$ will be retrieved with an estimated
$\elden$, such that $\elden_{\elkey} \in \setkey_\elpcset$.
Thus, $\elnum = \Gamma(\elpcset, \elden_{\elkey})$. This
will return a \gls{rna} of the form shown in
\refeq{numerator_from_pcset_den}.

\begin{equation}
    \label{eq:numerator_from_pcset_den}
    \elkey \; \text{:} \; \Gamma(\elpcset, \elden) \; \text{/} \; \elden
\end{equation}

In the \gls{rna} of \refeq{numerator_from_pcset_den}, the
key $\elkey$ and $\elpcset$ are given inputs, the
tonicization $\elden$ is a forced tonicization computed by
this method, and the numerator $\elnum$ is a chord relative
to the tonicized key $\elden$. The next section describes
the process of obtaining $\elden$.
