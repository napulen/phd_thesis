% Copyright 2022 Néstor Nápoles López

Consider the case of $\Gamma(\elpcset, \elkey)$ when
$\elpcset = \pcsetcdFa$ and $\elkey = \keyC$. In that case,
$\elpcset$ has an associated numerator $\elnum \in \setnum$
with the subset of keys shown in \refeq{key_not_found}.
Thus, that subset of keys is $\setkey_\elpcset$, as shown in
\refeq{key_not_found2}. 

\begin{equation}
    \label{eq:key_not_found}
    \elpcset = \pcsetcdFa \text{ in key } \elkey =
    \begin{cases}
        \keyfs & \quad \elnum = \rnGer \\
        \keyFs & \quad \elnum = \rnGer \\
        \keygb & \quad \elnum = \rnGer \\
        \keyg  & \quad \elnum = \rnVsev \\
        \keyGb & \quad \elnum = \rnGer \\
        \keyG  & \quad \elnum = \rnVsev \\
    \end{cases}
\end{equation}

\begin{equation}
    \label{eq:key_not_found2}
    \setkey_\elpcset = \{ \keyfs, \keyFs, \keygb, \keyg, \keyGb, \keyG \}
\end{equation}

However, we can see that for the given key $\elkey = \keyC$,
$\elkey \not\in \setkey_\elpcset$. In this case, a
tonicization $\elden$ will be computed, such that $\elden
\in \setkey_\elpcset$. The computed tonicization $\elden$
must be a ``closely related'' key to $\elkey$, in order for
the tonicization to be reasonable.

One way to compute a ``closely related'' key is to use a
metric of key distance between $\elkey$ and all keys $\elden
\in \setkey_\elpcset$.


An experienced analyst would perhaps assume that the chord
is referring to a \emph{dominant of the dominant} chord,
$C:\rnVsev/V$. Thus, related to the interpretation
$G:\rnVsev$ but in a tonicized $G$ major key. Most of the
times that interpretation would be correct, however, it is
not trivial to disambiguate the tonicization context
programmatically.

One way to find a reasonable tonicization given the key
context is to use a key distance algorithm to find the
tonicization that would minimize the distance between the
key provided and the tonicization.
