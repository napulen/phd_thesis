% Copyright 2022 Néstor Nápoles López

An \gls{arna} model is more than a neural network
architecture. It should be seen as an end-to-end model that
consists both of machine learning components and musical
decisions. When I started this project, I assumed that the
goal was to create a ``machine learning model'' that would
solve the problem. However, from the beginning, parsing
different datasets in different annotation formats soon made
me realize that domain knowledge was necessary to clean the
datasets, standardize their musical assumptions, define the
chord vocabulary, and guide the design of the network. This
is true for the output of the model as well. For example,
determining the number of classification outputs and how
these are defined, the number of key layers in the musical
analysis, or the spelling of certain Roman numerals (e.g.,
that infamous $\rn{I}\rnsixfour$ vs $\rn{V}\rnsixfour$). All
of these aspects shape the design of an \gls{arna} model.

Out of the ideas explored in the comparison process, the
\gls{natem} algorithm seems particularly promising to me in
future experiments. The design of tonal music analysis
models is open to the interpretation of the researchers
implementing them. This makes it very difficult to compare
them. Perhaps the distribution of \reftab{rare_chords}
summarizes my current thoughts on the design of the
\gls{arna} models. Even if a model is not competitive in
most metrics, it may be useful in certain situations, or
adopt certain design patterns that result beneficial for
certain types of music or certain types of chords. Thus, it
is worth the effort to search for tools that allow these
models to ``communicate'' with each other, and obtain
feedback on the things they do well and do poorly. Taking
the performance on the $\rnFr$ as an example, noticing the
peculiar intervallic configuration of the chord and
designing a representation that exploits it might be the
difference between recognizing all $\rnFr$ or none. 

\phdfigurefullpage[Comparison of the annotations provided by
a human analyst and various \gls{arna} models. The musical
excerpt is from Haydn's Op. 20 No. 3 - IV, a piece in the
\gls{haydnsun} test set. The annotations from the \gls{arna}
models that differ from the human analyst's are marked in
red]{haydn_comparison}

In order to complement the quantitative results presented in
this section, \reffig{haydn_comparison} shows a musical
excerpt analyzed by the various \gls{arna} systems. For
reference, the example also shows the human annotations
(``ground truth'') in the dataset. The key of the excerpt is
$\keyg$, which all of the models except \gls{melisma}
predict correctly. A brief discussion of the results by each
model is presented below. 

\paragraph{Analysis of the Melisma model.}

In general, the \gls{melisma} model seems to present more
flaws than all other \gls{arna} models. The most important
perhaps being mislabelling the key. After that, it misses
the initial annotation of the tonic triad (m.1, beat 1). The
model also has a tendency to provide long streams of chord
annotations (e.g., m. 3), which greatly differs from the
harmonic rhythm described by the human annotator or the
other \gls{arna} models. 

\paragraph{Analysis of the Chen and Su model.}

After inspecting the annotations of \gls{melisma}, the
\textcite{chen2021attend} model seems to provide better
predictions. Importantly, all but one of the annotations
(the $\rnIt\rnsix$ chord on measure 8, beat 2) in
\textcite{chen2021attend} are either tonic or dominant
chords. This speaks about the bias that exists for the Roman
numeral classes that appear more often in the dataset, as
shown in \reftab{rare_chords}. 

\paragraph{Analysis of the Micchi et al. model.}

The \textcite{micchi2021deep} model is less biased towards
tonic and dominant classes. For example, it recognizes
instances of diminished chords (e.g., m.~2, beat 3). The
model seems to struggle with the chord segmentation, as
chords are often in odd locations. For example, the
precipitated \gls{neapolitan} (m. 9, beat 3), or the tonic
triad at the beginning of the second system (m.6, beat 2.5).
This is perhaps because the musical excerpt is anacrusic,
and it makes it more complicated for the model to predict
the harmonic rhythm. 

\paragraph{Analysis of the McLeod and Rohrmeier model.}

The \textcite{mcleod2021modular} model does not seem to
suffer from segmentation problems. In general, it also seems
fairly similar to the human annotator. Two drawbacks of this
model is that it often predicts the wrong inversion (e.g.,
m.~1, beat 3; m.~5, beat 3; and m.~6, beat 3). In addition
to this, it is unable to recognize the $\rnGer$ chord in the
musical excerpt (m.~8, beat 2), proposing an annotation of
$\rnVI\rnsix$ instead. The label of $\rnVI\rnsix$ is a
reasonable prediction when ignoring the $\pitchCs$ in the
first violin. However, this intervallic relationship between
$\pitchEb$4 and $\pitchCs$5 is precisely what characterizes
the \gls{augsix} chord.

\paragraph{Analysis of the AugmentedNet.}

The proposed model in this dissertation, \gls{augmentednet},
is the only model that seems to be able to recognize the
chord discussed above, the $\rnGer$ \gls{augsix} in measure
8. Other models provide either an $\rnIt$ label, or in the
case of The prediction of $\rnIt$ here is expected in
\textcite{chen2021attend} and \textcite{micchi2021deep}, as
these models collapse the various flavours of \gls{augsix}
chords into one category, which makes it difficult (maybe
impossible) to distinguish between a $\rnIt$ and $\rnGer$.
Notice also that there are two errors in the human analysis.
In measure 2, beat 1, the analyst indicated a $\rni\rnsix$
label, however, because the viola crosses the violoncello at
that point, the chord is in fact in root position. All
\gls{arna} models unequivocally get this annotation right.
The second error in the annotation lies in the inversion of
the $\rnGer$ chord, indicated by the annotator as ``root
position.'' The \gls{augmentednet} model gets the annotation
in the proper inversion, according to the convention for
chord inversions used in the \gls{romantext}
format.\footnote{This particular set of chords,
\gls{augsix}, often have differing regarding their
inversions.}

% The string quartet example features a polyphonic texture,
% which would be difficult to analyze by a simple model
% (e.g., one that assumes the absence)