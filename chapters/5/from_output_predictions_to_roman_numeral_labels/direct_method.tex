% Copyright 2022 Néstor Nápoles López

The \gls{mtl} configuration of the model is tightly coupled
with the vocabularies defined for $\setkey$ (see
\refsec{thevocabularyofmusicalkeys}), $\setnum$ (see
\refsec{thevocabularyofromannumeralnumerators}), $\setden$
(see \refsec{thevocabularyofromannumeraldenominators}), and
$\setinv$ (see
\refsec{thevocabularyofarabicnumeralinversions}). Thus, the
output labels of the \gls{arna} model can be generated as
shown in \refeq{rna_pred}. 

\begin{equation}
    \label{eq:rna_pred}
    \elrnapred_{\elonsetpred} = \elkeypred : \elnumpred^{\elinvpred} \; / \; \eldenpred
\end{equation}

In \refeq{rna_pred}, $\elkeypred \in \setkey$ is the key
prediction of the \gls{localkey38} classifier, $\elnumpred
\in \setnum$ is the Roman numeral numerator prediction of
the \gls{rn31} classifier, $\eldenpred \in \setden$ is the
tonicization prediction of the \gls{tonicization38}
classifier, $\elinvpred \in \setinv$ is an inversion
indirectly obtained from the prediction of the \gls{bass35}
classifier, and $\elrnapred \in \setrna$ is the final
\gls{rna} label prediction. In the string form of the
\gls{rna} label, the tonicization $\eldenpred$ needs to be
encoded as a relative scale degree of the key $\elkeypred$.
Furthermore, the inversion $\elinvpred$ needs to be
determined from the prediction of the \gls{bass35}
classifier in the context of the chord implied by
$\elnumpred$. Thus, the inversion is going to be the last
step of the method. The rest of the variables are direct
predictions from the \gls{crnn}. However, one issue that is
yet to be addressed before generating the labels is which of
the 640 timesteps should be considered the location of a
\gls{rna} label. 

% This requires an approach for chord segmentation, where
% the onset predictions $\elonset \in \setonset$ starting
% from the predictions of the \gls{crnn} is to decide the
% chord segmentation. That is, which of the 640 timesteps
% should be considered the location of a \gls{rna} label.
% This is the first problem to be solved.
