% Copyright 2022 Néstor Nápoles López

Although the predictions provided by the \gls{crnn} are
crucial to determine the \gls{rna} labels generated by the
\gls{arna} model, there is another important step left,
which is to turn those predictions into \gls{rna} labels.

As mentioned in
\refsec{thestructureofaromannumeralanalysislabel}, a Roman
numeral label $\elrna \in \setrna$ could be defined as a
string with four components: a key $\elkey \in \setkey$, a
numerator $\elnum \in \setnum$, a tonicization (denominator)
$\elden \in \setden$, and an inversion $\elinv \in \setinv$,
as shown in \refeq{rna}. Thus, if those four pieces of
information are known, an \gls{rna} label that conforms to
this structure can be generated.

\begin{equation}
    \label{eq:rna}
    \elrna = \elkey : \elnum^{\elinv} \; / \; \elden
\end{equation}

Two methods are proposed to retrieve these four pieces of
information from the predictions of a machine learning
model. The first one, the \emph{direct} method, is tightly
coupled with the configuration of the \gls{crnn} proposed
here. Particularly, it benefits from the \gls{mtl}
configuration and the chosen output tasks. The second method
is more generic, as it only requires a \gls{pcset}
$\elpcset$ and key $\elkey$. In the second method, the
numerator $\elnum$ and tonicization $\elden$ are estimated
from $\elpcset$ and $\elkey$. Thus, I refer to the second
method as the \emph{indirect} method. 


% The latter can be used, for example, to generate a
% \gls{rna} from the predictions of other \gls{arna} methods
% \parencite{mcleod2021modular}. 

% \phdtable[Predictions from the \gls{crnn} for the Clara
% Schumann example presented at the beginning of the
% chapter]{crnn_predictions}

% The design of the algorithm served two purposes: to
% standardize the resolution of tonicizations in \gls{rna}
% labels, and to guarantee that an \gls{rna} label would be
% generated even when the predictions of the network
% resulted nonsensical.

% There is not a unique way to do this, because multiple
% tasks provide overlapping information. For example, the
% \gls{satb35} tasks and the \gls{pcset121} task can both be
% used to retrieve the chord. These different tasks are
% often advantageous in different musical situations. They
% might also require a different postprocessing.

% Thanks to the approach followed to resolve \gls{rna}
% labels from \gls{pcset}s and keys, these are the main two
% pieces of information needed from the predictions of the
% neural network to generate a final \gls{rna} string. There
% are, however, a few exceptions.

% The \gls{satb35}, \gls{pcset121}, and \gls{rn31} tasks can
% all be used to retrieve the \gls{pcset}.

