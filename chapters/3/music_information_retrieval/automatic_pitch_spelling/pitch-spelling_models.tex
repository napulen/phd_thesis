% Copyright 2021 Néstor Nápoles López

% This is \refsubsubsec{pitch-spellingmodels}, which
% introduces the pitch-spelling models.

% \guide{Longuet-Higgins (1976)}
\textcite{longuethiggins1976perception} presented what is
probably the first pitch-spelling algorithm, which was
constrained to monophonic melodies. Longuet-Higgins
considered that any note could be assigned a number, $p$,
based on 3-variables that related the note with respect to
\emph{middle C}: the distance in perfect fifths, the
distance in major thirds, and the octave. Using that
methodology, Longuet-Higgins extended the notation to add a
``sharpness'' feature, $q$, which was defined based on the
distance in fifths and thirds to \emph{middle C}, regardless
of the octave. This ``sharpness'' value, in conjunction with
the \gls{midi} note number, was used to indicate the
spelling of the note.

% \guide{Cambouropoulos (2003)}
After a gap of around 25 years, a series of new algorithms
were developed by different researchers independently,
almost at the same time. \textcite{cambouropoulos2003pitch}
presented an approach that relied on intervals. The
algorithm used a shifting overlapping window (suggested to
be of 9 to 12 pitches long). The window moved along the
sequence of pitches, from left to right, until the sequence
concluded. For each window, the pitch-spelling process
optimized two aspects: 1) that notes make the minimum use of
accidentals (something that Cambouropoulos referred to as
\emph{notational parsimony}), and 2) the avoidance of 8
classes of augmented and diminished intervals (something
that Cambouropoulos referred to as \emph{interval
optimization}). The algorithm was evaluated on Mozart piano
sonatas and Chopin Waltzes.

% \guide{Chew and Chen (2003)}
The \emph{Spiral Array} introduced by
\textcite{chew2000towards} in her dissertation was used for
multiple tasks that involved tonal analysis. Namely, chord
labeling, key-finding, and pitch-spelling. The Spiral Array
is a spatial representation of tonality that allows a
sequence of pitches to be positioned in
a---theoretical---tonal space, which facilitates the
computation of tonal features in different ways. Regarding
pitch-spelling, three different algorithms were proposed by
\textcite{chew2003determining} that were built on top of
each other. In the paper, their evaluation of the algorithms
was restricted to few movements of Beethoven's piano
sonatas.

% \guide{Temperley and Sleator (2004)}
Throughout the late 1990s and early 2000s, Temperley
developed a series of algorithms for modelling different
aspects of musical structure (i.e., meter, phrasing,
counterpoint, harmony, key, and pitch-spelling). These
models were implemented by Daniel Sleator in the
\emph{Melisma Music Analyzer} and explained in detail in the
book by \textcite{temperley2004cognition}. Regarding
pitch-spelling, the approach by Temperley consists of a
rule-based system based on his concepts of \gls{tpc} and the
\emph{line of fifths}. Additionally, the algorithm depended
on the metrical analysis provided by the Melisma Music
Analyzer before extracting the spelling of the notes.

% \guide{Meredith (2003)}
\textcite{meredith2003pitch} introduced an algorithm that
received \gls{midi} note numbers and onset times as ordered
pairs and determined the spelling of the notes through two
stages. The first stage consisted of a rule-based system
with eight sequential rules. After this stage, a spelling
was already determined. The second stage corrected the
outputs of the first stage, taking neighboring and passing
notes into account, which could have been erroneously
spelled in the first stage. In a subsequent study,
\textcite{meredith2005comparing} compared its pitch-spelling
algorithm against other pitch spelling algorithms.

% \guide{Stoddard et al. (2004)}
\textcite{stoddard2004welltempered} proposed a data-driven
algorithm for pitch-spelling. It required ground-truth
spelling information in order to be trained. Additionally,
the algorithm ran on top of the probabilistic framework for
harmonic analysis by \textcite{raphael2003harmonic},
conditioned by the accuracy of that harmonic analysis model.
The algorithm was evaluated over a total of 22,593 notes,
scoring 96.87\% accuracy. During their study, they found
that the detection and resolution of voice-leading
considerations (i.e., the relationship between a note and
its immediate neighbors) was the most important feature to
consider in a pitch-spelling algorithm.

% \guide{Teodoru and Raphael (2007)}
\textcite{teodoru2007pitch} tackled the problem by assuming
that the spelling of a note depended on voice leading and
local harmony. They observed principles for spelling notes
in music theory textbooks
\parencite{aldwell1978harmony,rimskykorsakov2005practical}
and built a probabilistic model that captured these
principles through \emph{Markov chains}. In their
evaluation, they showed that their model outperformed other
models, including the one by \textcite{meredith2006ps13}.
Nevertheless, an important limitation of their model was
that it relied on \emph{voice} information being provided as
part of the input, which is not the case for most \gls{midi}
data available online and, therefore, limits the practical
application of the algorithm. In their study, they found
that \gls{lke} is fundamental for pitch spelling.
Additionally, they considered that the relationship between
local keys and spelling is bidirectional. That is, spelling
can influence the choice of key as much as the key can
influence the choice of spelling.
