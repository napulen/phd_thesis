% Copyright 2021 Néstor Nápoles López

% This is \refsubsubsec{local-keyestimationmodels}, which
% introduces the local-key estimation models.


Contrary to the global-key estimation approaches, local-key
estimation models have a relatively recent history.

% Audio
\textcite{purwins2000new} introduced a method for tracking
changes of key in audio signals using cq-profiles, which are
calculated with the constant Q filter bank. Their goal is to
track the tone center and its variation during the piece.
Their references annotate both modulations and tonicizations
but consider that the ground truth is the one indicated by
the tonicizations.

% symbolic
\textcite{chew2002spiral} measured the distance from a
sequence of pitches to a key using the \emph{spiral array}.
The succession of keys is then modeled as a sequence of
\emph{boundaries} dividing the score in different key areas.

% Audio
\textcite{chai2005detection} designed a model based on a
Hidden Markov Model (\gls{hmm}) to detect changes of key.
They describe the term \emph{modulation} as ``the change of
key at some point''. Their model detects, at first, the
tonal center, and then, the mode of the key.

% Audio
\textcite{catteau2007probabilistic} introduced a model for
scale and chord recognition, assuming that there is a
correspondence between a major scale and a major key, and
between a harmonic minor scale and a minor key. Their model
is based on the key profiles by
\textcite{temperley1999whats} and Lerdahl's \emph{tonal
pitch space} \parencite{lerdahl2005tonal}.

\textcite{izmirli2007localized} proposed a model to find
local keys in audio signals. As a pre-processing step, the
model adapts the tuning of the signal before computing the
spectral analysis and the chroma features. In a later stage,
Non-negative matrix factorization is used to segment
contiguous chroma vectors, identifying potential local keys.
The model identifies segments that are candidates for unique
local keys in relation to the neighboring key centers. The
model was evaluated in three datasets: 17 pop songs with at
least one modulation, excerpts from the beginning of 152
classical music pieces from the Naxos website, and the
examples from the \textcite{kostka1984tonal} harmony
textbook. In the paper, the results for three different
evaluation methods are provided for each of the datasets.
Izmirli also attempted to disambiguate modulations and
tonicizations in the following manner: ``Secondary functions
and tonicizations are heard as short deviations from the
well-grounded key in which they appear---although the
boundary between modulation and tonicization is not clear
cut. A modulation unambiguously instigates a shift in the
key center''. This work is also, to the best of my
knowledge, the first time that the term \emph{local keys}
has been mentioned in an \gls{mir} publication.

\textcite{papadopoulos2009local} adopted a similar approach
to Izmirli for audio local-key estimation. Their model
attempts to segment the score based on the points of
modulation. They introduced key dependencies on the harmonic
and metric structures of global-key-finding methods, in
order to convert them into local-key-finding ones.
% They also discussed the need for more data in chords and
% local key.

\textcite{rocher2010concurrent} introduced a model that
provides (chord, key) duples for each audio frame of an
input excerpt. The model is based on a graph and the
\emph{best-path} estimation method. For evaluating key
distances, they used the key profiles by
\textcite{temperley1999whats}. The authors alluded to the
term modulation when discussing their key predictions.

\textcite{mearns2011automatically} used an \gls{hmm} to
estimate modulations over audio transcriptions of Bach
chorales. The \gls{hmm} is trained with chord progressions.
The emission probability distributions are obtained from two
tables with the probabilities of chords existing in a given
key. These tables are based on the work by Schoenberg and
Krumhansl. Applied chords (i.e., tonicizations) are not
described in these charts, therefore, the authors do not
deal with tonicizations.

\textcite{pauwels2014combining} presented a probabilistic
framework for the simultaneous estimation of chords and keys
from audio. They mention the importance of ``integrating
prior musical knowledge'' into a local-key-estimation
system, however, they do not allude to the terms modulation
and tonicization. The same year,
\textcite{weis2014chromabased} proposed an audio scale
estimator. They argue that this estimator can help to
determine the local tonality based on G\'{a}rdonyi's scale
analysis method. They did not use the term tonicization,
however, they discussed ``short-time local modulations'',
which resemble tonicizations.

Machine learning approaches, especially using neural
networks, have recently gained popularity in \gls{mir}
research, including key estimation. Independently,
\textcite{chen2018functional, chen2019harmony} and
\textcite{micchi2020not} designed models that estimate local
keys as well as roman numeral analysis annotations.
Tonicization information is implied by the roman numeral
analysis annotations.

N\'apoles L\'opez et al. introduced a model to find changes
of key (local-key estimation) as well as the main key of a
piece (global-key estimation), using an \gls{hmm}
\textcite{napoleslopez2019keyfinding}. The model is also
capable of working with symbolic and audio data. They do not
allude to the terms modulation or tonicization, always
referring to their predictions as \emph{local keys}.

One of the most recent models for finding changes of key is
by \textcite{feisthauer2020estimating}, which has been
designed to detect modulations in Classical music. It uses
three proximity measures established from pitch
compatibility, tonality anchoring, and tonality proximity.
The model computes the cost of being in a key on a given
beat, and estimates the succession of keys using dynamic
programming techniques.
